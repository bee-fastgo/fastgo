<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bee.team.fastgo.mapper.ProjectDoMapperExt">

    <!--查询后台项目列表-->
    <select id="findBackPorjectList" parameterType="map" resultType="com.bee.team.fastgo.vo.project.ProjectListVo">
        select id,projectName,projectCode,projectDesc,gitUrl,projectStatus,packageName,autoDeploy from t_project where projectType = '2'
        limit #{start},#{limit}
    </select>

    <!--查询前台项目列表-->
    <select id="findFrontPorjectList" parameterType="map" resultType="com.bee.team.fastgo.vo.project.ProjectListVo">
        select id,projectName,projectCode,projectDesc,gitUrl,projectStatus,packageName,autoDeploy from t_project where projectType = '1'
        limit #{start},#{limit}
    </select>

    <!--查询项目信息-->
    <select id="queryProjectInfo" parameterType="map" resultType="com.bee.team.fastgo.model.ProjectDo">
        select * from t_project p
        inner join t_project_profile pp on p.projectCode = pp.projectCode
        where pp.profileCode = #{code}
    </select>

    <!--查询部署所需项目信息-->
    <select id="findDeployProjectInfo" parameterType="java.lang.String" resultType="com.bee.team.fastgo.service.api.server.dto.req.SimpleDeployDTO">
        select p.projectName,p.gitUrl,pr.runServerIp as runServerIp from t_project p
        inner join t_project_profile pp on p.projectCode = pp.projectCode
        inner join t_profile_runprofile_relation pr on pr.profileCode = pp.profileCode
        where p.projectCode = #{projectCode}
    </select>

</mapper>